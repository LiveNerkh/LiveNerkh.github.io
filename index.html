 <!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LiveNerkh | قیمت لحظه‌ای</title>
  <style>
    body { font-family: Tahoma, sans-serif; background: #f2f2f2; margin:0; color:#333 }
    header { background:#ffbf00; padding:15px; text-align:center; color:white; }
    .ticker { background:#333; color:white; padding:8px; overflow:hidden; white-space:nowrap; }
    .ticker span { display:inline-block; padding-left:100%; animation:ticker 30s linear infinite; }
    @keyframes ticker { 0% {transform:translateX(-100%);} 100% {transform:translateX(100%);} }

    main{max-width:1000px;margin:20px auto;background:white;padding:20px;border-radius:10px;}
    section{margin-bottom:30px;}
    h2{background:#f8b500;color:white;padding:10px;border-radius:6px;text-align:center;}
    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{padding:10px;text-align:center;border-bottom:1px solid #ddd;}
    th{background:#f8b500;color:white;}
    td.price{font-weight:bold;color:#ff6600;}
    .pos{color:green;} .neg{color:red;}

    footer{text-align:center;padding:15px;color:#666;}
  </style>
</head>
<body>

<header><h1>LiveNerkh | قیمت‌های لحظه‌ای</h1></header>
<div class="ticker"><span id="newsTicker">در حال دریافت اخبار...</span></div>

<main>
  <!-- طلا و سکه -->
  <section><h2>طلا و سکه</h2>
    <table>
      <tr><td>طلا ۱۸ عیار (ایران)</td><td id="goldPrice">-</td></tr>
      <tr><td>طلای جهانی</td><td id="globalGoldPrice">-</td></tr>
      <tr><td>سکه امامی</td><td id="emamiCoin">-</td></tr>
      <tr><td>سکه بهار آزادی</td><td id="baharCoin">-</td></tr>
      <tr><td>نیم سکه</td><td id="halfCoin">-</td></tr>
      <tr><td>ربع سکه</td><td id="quarterCoin">-</td></tr>
    </table>
  </section>

  <!-- ارزهای همسایه -->
  <section><h2>ارزهای کشورهای همسایه</h2>
    <table id="neighborTable">
      <thead><tr><th>واحد</th><th>قیمت (تومان)</th></tr></thead>
      <tbody>
        <tr><td>AED (درهم)</td><td id="AED">-</td></tr>
        <tr><td>AFN (افغانی)</td><td id="AFN">-</td></tr>
        <tr><td>AZN (منات)</td><td id="AZN">-</td></tr>
        <tr><td>TRY (لیر)</td><td id="TRY">-</td></tr>
        <tr><td>RUB (روبل)</td><td id="RUB">-</td></tr>
        <tr><td>JPY (ین)</td><td id="JPY">-</td></tr>
        <tr><td>GBP (پوند)</td><td id="GBP">-</td></tr>
      </tbody>
    </table>
  </section>

  <!-- ارزهای دیجیتال -->
  <section><h2>رمزارزها (برحسب تتر)</h2>
    <table id="cryptoTable">
      <thead><tr><th>نام</th><th>قیمت (تتر)</th></tr></thead>
      <tbody id="cryptoBody"></tbody>
    </table>
  </section>

  <!-- آمار -->
  <h2 style="text-align:center;">بازدید امروز: <span id="visitCountToday">0</span></h2>
  <h2 style="text-align:center;">بازدید دیروز: <span id="visitCountYesterday">0</span></h2>
</main>

<footer>طراحی شده توسط LiveNerkh | همه حقوق محفوظ است ❤️</footer>

<script>
  const tomanRate = 50000;

  async function loadNews() {
    try {
      const resp = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://tasnimnews.com/fa/rss/allnews');
      const data = await resp.json();
      const titles = data.items.slice(0,10).map(i => i.title);
      document.getElementById('newsTicker').textContent = titles.join(' ✦ ');
    } catch {
      document.getElementById('newsTicker').textContent = 'عدم امکان دریافت اخبار';
    }
  }

  async function fetchPrices() {
    try {
      // طلا و سکه
      const g = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,usd-gold&vs_currencies=usdt,usd');
      const d2 = await g.json();
      const usdGold = d2['usd-gold'].usd;
      document.getElementById('globalGoldPrice').innerText = usdGold.toLocaleString() + ' $';
      document.getElementById('goldPrice').innerText = (usdGold * tomanRate).toLocaleString() + ' تومان';

      const usd = (await fetch('https://api.coingecko.com/api/v3/exchange_rates')).then(r=>r.json()).then(d=>d.rates.usd.value* tomanRate);
      // سکه تخمینی
      ['emamiCoin','baharCoin','halfCoin','quarterCoin'].forEach((id,i)=>{
        const mult = [10,9.8,5,2.5][i];
        usd.then(u => document.getElementById(id).innerText = (u*mult).toLocaleString()+' تومان');
      });

      // ارزهای همسایه با currency-api
      const cur = await fetch('https://latest.currency-api.pages.dev/v1/currencies/all.json').then(r=>r.json());
      ['AED','AFN','AZN','TRY','RUB','JPY','GBP'].forEach(code=>{
        const val = cur[code].usd * tomanRate;
        document.getElementById(code).innerText = val.toLocaleString()+' تومان';
      });

      // رمزارزها
      const crypt = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usdt&order=market_cap_desc&per_page=100&page=1');
      const list = await crypt.json();
      document.getElementById('cryptoBody').innerHTML = list.map(c => {
        const cls = c.price_change_percentage_24h > 0 ? 'pos' : 'neg';
        return `<tr><td>${c.name}</td><td class="${cls}">${c.current_price.toLocaleString()} تتر</td></tr>`;
      }).join('');
    } catch(e){
      console.error(e);
    }
  }

  function countVisits() {
    const td=new Date(), yd=new Date(td); yd.setDate(td.getDate()-1);
    const k1='v_'+td.toLocaleDateString(),k2='v_'+yd.toLocaleDateString();
    let a=localStorage.getItem(k1),b=localStorage.getItem(k2)||0;
    a=a?+a+1:1;
    localStorage.setItem(k1,a);
    document.getElementById('visitCountToday').innerText=a;
    document.getElementById('visitCountYesterday').innerText=b;
  }

  loadNews(); fetchPrices(); countVisits();
  setInterval(loadNews,60000);
  setInterval(fetchPrices,10000);
</script>
